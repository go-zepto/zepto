(this.webpackJsonpwebapp=this.webpackJsonpwebapp||[]).push([[0],{560:function(e,n,t){"use strict";t.r(n);var r=t(0),o=t.n(r),c=t(17),i=t.n(c),a=t(639),u=t(116),s=t(243),f=/(or_)?([_a-zA-Z0-9]+)_(eq|gt|gte|lt|lte|between|in|nin|like|nlike)/,l=function(e){var n={};return Object.keys(e).forEach((function(t){var r=f.exec(t);if(4===(null===r||void 0===r?void 0:r.length)){var o="or_"===r[1]?"or":"and",c=r[2],i=r[3],a={};a[c]={},a[c][i]=e[t],n[o]||(n[o]=[]),n[o].push(a)}})),n},d=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.a.fetchJson;return{getList:function(t,r){var o=l(r.filter),c=r.pagination,i=c.page,a=c.perPage,u={skip:(i-1)*a,limit:a,where:o},f={filter:JSON.stringify(u)},d="".concat(e,"/").concat(t,"?").concat(Object(s.stringify)(f));return n(d).then((function(e){e.headers;var n=e.json;return{data:n.data,total:n.count}}))},getOne:function(t,r){var o="".concat(e,"/").concat(t,"/").concat(r.id);return n(o).then((function(e){e.headers;return{data:e.json}}))},getMany:function(t,r){var o={filter:JSON.stringify({id:r.ids})},c="".concat(e,"/").concat(t,"?").concat(Object(s.stringify)(o));return n(c).then((function(e){return{data:e.json.data}}))},getManyReference:function(e,n){return Promise.resolve({})},update:function(t,r){return n("".concat(e,"/").concat(t,"/").concat(r.id),{method:"PUT",body:JSON.stringify(r.data)}).then((function(e){return{data:e.json}}))},updateMany:function(e,n){return Promise.resolve({})},create:function(t,r){return n("".concat(e,"/").concat(t),{method:"POST",body:JSON.stringify(r.data)}).then((function(e){return{data:e.json}}))},delete:function(e,n){return Promise.resolve({})},deleteMany:function(e,n){return Promise.resolve({})}}},p=t(13),j=function(e){return Object(p.jsx)(a.a,{dataProvider:d("http://localhost:8000/api"),children:e.resComponents})},b=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,652)).then((function(n){var t=n.getCLS,r=n.getFID,o=n.getFCP,c=n.getLCP,i=n.getTTFB;t(e),r(e),o(e),c(e),i(e)}))},m=t(638),O=t(22),h=t(646),v=t(640),x=t(625),g=t(626),_=t(627),y=t(628),C=t(650),R=t(629),w=t(644),S=t(645),G=t(630),I=t(350),P=["title","name","first_name","full_name"],F=function(e){if(0===e.list_fields.length)return null;var n,t=e.list_fields.map((function(e){return e.name})),r=Object(I.a)(P);try{for(r.s();!(n=r.n()).done;){var o=n.value;if(t.includes(o))return o}}catch(c){r.e(c)}finally{r.f()}return null},N=t(11),k=t(358),T=t(104),D=t(84),J=t(632),L=t(77),M=t(27),z=function(e){var n=e.recordID,t=Object(J.a)(),o=Object(r.useState)([]),c=Object(N.a)(o,2),i=c[0],a=c[1],u=Object(L.a)();Object(r.useEffect)((function(){var t={};t["".concat(e.refResourceFieldName,"_eq")]=n,u.getList(e.resource.endpoint,{filter:t,pagination:{page:1,perPage:10},sort:{field:"id",order:"ASC"}}).then((function(e){a((null===e||void 0===e?void 0:e.data)||[])}))}),[u,e.refResourceFieldName,e.resource.endpoint,n,a]);var s=e.resource.list_fields.map((function(e){return{field:e.name,headerName:e.options.label,flex:"id"===e.name?.3:1}}));return Object(p.jsx)("div",{style:{height:400,width:"100%",marginBottom:"32px"},children:Object(p.jsx)(k.a,{rows:i,columns:s,pageSize:5,rowHeight:48,disableColumnMenu:!0,disableSelectionOnClick:!0,disableColumnSelector:!0,componentsProps:{toolbar:{resource:e.resource,refResourceFieldName:e.refResourceFieldName,recordID:n}},onRowClick:function(n){t("/".concat(e.resource.endpoint,"/").concat(n.row.id))},components:{Toolbar:function(e){var n={};return n[e.refResourceFieldName]=e.recordID,Object(p.jsxs)("div",{style:{padding:"20px",borderBottom:"1px solid #e9e9e9",overflow:"auto"},children:[Object(p.jsx)("div",{style:{float:"left"},children:Object(p.jsx)(D.a,{variant:"h3",style:{fontSize:"20px"},children:e.resource.name})}),Object(p.jsx)("div",{style:{float:"right"},children:Object(p.jsx)(T.a,{size:"small",variant:"contained",color:"primary",component:M.a,to:{pathname:"/".concat(e.resource.endpoint,"/create"),state:{record:n}},children:"Create"})})]})}}})})},B=t(633),E={text:{fieldCompGen:function(e,n){return function(e){return Object(p.jsx)(R.a,Object(O.a)({},e))}},inputCompGen:function(e,n){return function(e){return Object(p.jsx)(B.a,Object(O.a)({},e))}}},number:{fieldCompGen:function(e,n){return function(e){return Object(p.jsx)(_.a,Object(O.a)({},e))}},inputCompGen:function(e,n){return function(e){return Object(p.jsx)(y.a,Object(O.a)({},e))}}},datetime:{fieldCompGen:function(e,n){return function(e){return Object(p.jsx)(x.a,Object(O.a)({},e))}},inputCompGen:function(e,n){return function(e){return Object(p.jsx)(g.a,Object(O.a)({},e))}}},reference:{fieldCompGen:function(e,n){return function(t){var r=e.resources.find((function(e){return e.name===n.options.ref_resource}));if(!r)return console.error('[ReferenceInput] Resource not found "'.concat(r,'"')),null;var o=n.options.text_field_name,c=o&&""!==o?o:F(r);return Object(p.jsx)(C.a,Object(O.a)(Object(O.a)({},t),{},{reference:null===r||void 0===r?void 0:r.endpoint,children:Object(p.jsx)(R.a,{source:c})}))}},inputCompGen:function(e,n){return function(t){var r=e.resources.find((function(e){return e.name===n.options.ref_resource}));if(!r)return console.error('[ReferenceInput] Resource not found "'.concat(r,'"')),null;var o=n.options.option_text_field,c=n.options.autocomplete;return Object(p.jsx)(w.a,Object(O.a)(Object(O.a)({},t),{},{reference:null===r||void 0===r?void 0:r.endpoint,filterToQuery:function(e){if(""===e)return{};var n={},t=c.searchable_fields,o=F(r);return(t.length>0?t.length:null!=o?[o]:[]).forEach((function(t){n["or_".concat(t,"_like")]="%".concat(e,"%")})),n},children:c&&c.enabled?Object(p.jsx)(S.a,{optionText:o}):Object(p.jsx)(G.a,{optionText:o})}))}}},reference_list:{fieldCompGen:function(e,n){return function(t){var r=e.resources.find((function(e){return e.name===n.options.ref_resource}));return r?Object(p.jsx)("div",{children:"TODO: ReferenceListField"}):(console.error('[ReferenceInput] Resource not found "'.concat(r,'"')),null)}},inputCompGen:function(e,n){var t=function(e,n){return function(t){var r=e.resources.find((function(e){return e.name===n.options.ref_resource}));if(!r)return console.error('[ReferenceInput] Resource not found "'.concat(r,'"')),null;var o=n.options.ref_resource_field_name;return Object(p.jsx)(z,{resource:r,refResourceFieldName:o,recordID:t.recordID})}}(e,n);return function(e){return Object(p.jsx)(t,Object(O.a)(Object(O.a)({},e),{},{recordID:e.record.id}))}}}},A=function(e,n){return E[n.type].inputCompGen(e,n)},q=function(e,n){var t=n.create_inputs.map((function(n){var t=A(e,n),r=n.options&&n.options.props||{};return Object(p.jsx)(t,Object(O.a)({source:n.name},r),n.name)}));return function(e){return Object(p.jsx)(h.a,Object(O.a)(Object(O.a)({},e),{},{children:Object(p.jsx)(v.a,{children:t.map((function(e){return e}))})}))}},H=t(643),Q=function(e,n){var t=(n.update_inputs.length>0?n.update_inputs:n.create_inputs).map((function(n,t){var r=A(e,n),o=n.options&&n.options.props||{};return Object(p.jsx)(r,Object(O.a)({source:n.name},o),t)}));return function(e){return Object(p.jsx)(H.a,Object(O.a)(Object(O.a)({},e),{},{children:Object(p.jsx)(v.a,{children:t.map((function(e){return e}))})}))}},U=t(641),Z=t(642),K={list:function(e,n){var t=n.list_fields.map((function(n){var t=function(e,n){return E[n.type].fieldCompGen(e,n)}(e,n),r=n.options&&n.options.props||{};return Object(p.jsx)(t,Object(O.a)({source:n.name},r),n.name)}));return function(e){return Object(p.jsx)(U.a,Object(O.a)(Object(O.a)({},e),{},{children:Object(p.jsx)(Z.a,{rowClick:"edit",children:t.map((function(e){return e}))})}))}},create:q,edit:Q},V=document.getElementById("root"),W=null===V||void 0===V?void 0:V.getAttribute("schema");u.a.fetchJson(W).then((function(e){var n=e.json,t=n.resources.map((function(e){return function(e,n){var t=K.list(e,n),r=K.create(e,n),o=K.edit(e,n);return Object(p.jsx)(m.a,{name:n.endpoint.toLowerCase(),list:t,create:r,edit:o},n.name)}(n,e)}));i.a.render(Object(p.jsx)(o.a.StrictMode,{children:Object(p.jsx)(j,{resComponents:t})}),V)})),b()}},[[560,1,2]]]);
//# sourceMappingURL=main.28a46e92.chunk.js.map